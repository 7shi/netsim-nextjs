(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4056:function(e,t,a){Promise.resolve().then(a.bind(a,1951))},1951:function(e,t,a){"use strict";a.d(t,{NetworkSimulator:function(){return F}});var r=a(7437),s=a(2265),n=a(1538),l=a(2218),i=a(4839),c=a(6164);function o(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,c.m6)((0,i.W)(t))}let d=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=s.forwardRef((e,t)=>{let{className:a,variant:s,size:l,asChild:i=!1,...c}=e,u=i?n.g7:"button";return(0,r.jsx)(u,{className:o(d({variant:s,size:l,className:a})),ref:t,...c})});u.displayName="Button";let m=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:o("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});m.displayName="Card",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:o("flex flex-col space-y-1.5 p-6",a),...s})}).displayName="CardHeader",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h3",{ref:t,className:o("text-2xl font-semibold leading-none tracking-tight",a),...s})}).displayName="CardTitle",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("p",{ref:t,className:o("text-sm text-muted-foreground",a),...s})}).displayName="CardDescription";let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:o("p-6 pt-0",a),...s})});p.displayName="CardContent",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:o("flex items-center p-6 pt-0",a),...s})}).displayName="CardFooter";var f=a(8485),x=a(2421),h=a(4392),g=a(2468);let y=f.fC;f.ZA;let w=f.B4,j=s.forwardRef((e,t)=>{let{className:a,children:s,...n}=e;return(0,r.jsxs)(f.xz,{ref:t,className:o("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...n,children:[s,(0,r.jsx)(f.JO,{asChild:!0,children:(0,r.jsx)(x.Z,{className:"h-4 w-4 opacity-50"})})]})});j.displayName=f.xz.displayName;let v=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(f.u_,{ref:t,className:o("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.jsx)(h.Z,{className:"h-4 w-4"})})});v.displayName=f.u_.displayName;let b=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(f.$G,{ref:t,className:o("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.jsx)(x.Z,{className:"h-4 w-4"})})});b.displayName=f.$G.displayName;let N=s.forwardRef((e,t)=>{let{className:a,children:s,position:n="popper",...l}=e;return(0,r.jsx)(f.h_,{children:(0,r.jsxs)(f.VY,{ref:t,className:o("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:n,...l,children:[(0,r.jsx)(v,{}),(0,r.jsx)(f.l_,{className:o("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,r.jsx)(b,{})]})})});N.displayName=f.VY.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(f.__,{ref:t,className:o("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...s})}).displayName=f.__.displayName;let C=s.forwardRef((e,t)=>{let{className:a,children:s,...n}=e;return(0,r.jsxs)(f.ck,{ref:t,className:o("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...n,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(f.wU,{children:(0,r.jsx)(g.Z,{className:"h-4 w-4"})})}),(0,r.jsx)(f.eT,{children:s})]})});C.displayName=f.ck.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(f.Z0,{ref:t,className:o("-mx-1 my-1 h-px bg-muted",a),...s})}).displayName=f.Z0.displayName;var R=a(2271),P=a(5302),S=a(6143),k=a(9687),D=a(4697),H=a(5430);function F(){let[e,t]=(0,s.useState)([]),[a,n]=(0,s.useState)(1),[l,i]=(0,s.useState)([]),[c,o]=(0,s.useState)(null),[d,f]=(0,s.useState)(null),[x,h]=(0,s.useState)(null),g=(0,s.useRef)(null),v=(0,s.useRef)({}),b=(0,s.useRef)(null),F=(0,s.useRef)({}),[A,M]=(0,s.useState)(11),q=()=>Array.from({length:6},()=>Math.floor(256*Math.random()).toString(16).padStart(2,"0")).join(":");(0,s.useEffect)(()=>{e.length||t([{id:0,name:"DHCP Server",os:"DHCP",mac:q(),isDHCP:!0,ip:"192.168.1.1",arpTable:{}}])},[e]);let O=a=>{t(e.filter(e=>e.isDHCP||e.id!==a)),c===a&&o(null),d===a&&f(null)},I=async(e,a)=>{t(t=>t.map(t=>t.id===e?{...t,os:a}:t)),null!==a&&"DHCP"!==a&&await $(e)},z=e=>{let{os:t}=e;switch(t){case"OS1":return(0,r.jsx)(R.Z,{className:"h-6 w-6 text-blue-500"});case"OS2":return(0,r.jsx)(P.Z,{className:"h-6 w-6 text-green-500"});case"DHCP":return(0,r.jsx)(S.Z,{className:"h-6 w-6 text-purple-500"});default:return(0,r.jsx)(k.Z,{className:"h-6 w-6 text-gray-400"})}},T=e=>{let t=v.current[e];if(!t)return null;let a=(t.querySelector("svg.h-6.w-6")||t).getBoundingClientRect();return{x:a.left+a.width/2,y:a.top+a.height/2}},_=async(e,t,a,r,s,n)=>{let l=performance.now(),i=c=>{let o=Math.min((c-l)/n,1),d=o<.5?4*o*o*o:1-Math.pow(-2*o+2,3)/2,u=e.getBoundingClientRect(),m=t+(r-t)*d-u.width/2,p=a+(s-a)*d-u.height/2;e.style.transform="translate(".concat(m,"px, ").concat(p,"px)"),o<1&&requestAnimationFrame(i)};return requestAnimationFrame(i),new Promise(e=>{setTimeout(e,n)})},Z=(e,t,a)=>"Ethernet Header:\n    Destination: ".concat(t,"\n    Source: ").concat(e,"\n    Type: ").concat(a),V=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"00:00:00:00:00:00",r=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,n=Z(t,"Discover"===e?"FF:FF:FF:FF:FF:FF":a,"0800"),l=Math.floor(4294967295*Math.random()).toString(16).padStart(8,"0"),i="";switch(e){case"Discover":i="350101";break;case"Offer":i="350102";break;case"Request":i="350103";break;case"Acknowledge":i="350105"}return"".concat(n,"\n\nDHCP ").concat(e,":\nOp: ").concat("Discover"===e||"Request"===e?"01":"02"," HType: 01 HLen: 06 Hops: 00\n").concat(l," Secs: 0000 Flags: 0000\nCIAddr: 00000000 YIAddr: ").concat(s?s.split(".").map(e=>parseInt(e).toString(16).padStart(2,"0")).join(""):"00000000","\nSIAddr: ").concat(r?r.split(".").map(e=>parseInt(e).toString(16).padStart(2,"0")).join(""):"00000000"," GIAddr: 00000000\nCHAddr: ").concat(t.replace(/:/g,""),"0000000000000000\nOptions: ").concat(i)},E=(e,t,a,r,s)=>{let n=Z(t,"Request"===e?"FF:FF:FF:FF:FF:FF":r,"0806");return"".concat(n,"\n\nARP ").concat(e,":\nHardware type: 0001 (Ethernet)\nProtocol type: 0800 (IPv4)\nHardware size: 06 Protocol size: 04\nOpcode: ").concat("Request"===e?"0001":"0002","\nSender MAC address: ").concat(t,"\nSender IP address: ").concat(a,"\nTarget MAC address: ").concat(r,"\nTarget IP address: ").concat(s)},B=(e,t,a,r,s)=>{let n=Z(t,a,"0800"),l="Request"===e?"08 00":"00 00",i=Math.floor(65535*Math.random()).toString(16).padStart(4,"0"),c=Math.floor(65535*Math.random()).toString(16).padStart(4,"0");return"".concat(n,"\n\nICMP ").concat(e,":\nType: ").concat(l," (Echo ").concat(e,")\nCode: 0\nChecksum: 0000\nIdentifier: ").concat(i,"\nSequence number: ").concat(c,"\nData:\n  abcdefghijklmnopqrstuvwabcdefghi\nSource: ").concat(r,"\nDestination: ").concat(s)},L=async(t,a,r,s)=>{let n={id:Date.now(),from:t,to:null!=a?a:-1,type:r,data:s};i(e=>[...e,n]);let l=T(t);if(l){if(null===a){let a=e.filter(e=>e.id!==t&&null!==e.os).map(e=>{let a=T(e.id);if(!a)return Promise.resolve();let s=F.current["zap-".concat(t,"-").concat(e.id)];return s?(s.style.display="block",s.classList.remove("text-green-400","text-yellow-400","text-blue-400","text-purple-400"),s.classList.add(G(r)),_(s,l.x,l.y,a.x,a.y,1e3).then(()=>{s.style.display="none"})):Promise.resolve()});await Promise.all(a)}else{let e=T(a);if(!e)return;let s=F.current["zap-".concat(t,"-").concat(a)];if(!s)return;s.style.display="block",s.classList.remove("text-green-400","text-yellow-400","text-blue-400","text-purple-400","text-orange-400","text-pink-400"),s.classList.add(G(r)),await _(s,l.x,l.y,e.x,e.y,1e3),s.style.display="none"}}},G=e=>{switch(e){case"DHCP Discover":case"DHCP Request":return"text-blue-400";case"DHCP Offer":case"DHCP Acknowledge":return"text-purple-400";case"ICMP Request":return"text-yellow-400";case"ICMP Reply":return"text-green-400";case"ARP Request":return"text-orange-400";case"ARP Reply":return"text-pink-400";default:return"text-gray-400"}},Y=(e,a,r)=>{t(t=>t.map(t=>t.id===e?{...t,arpTable:{...t.arpTable,[a]:{mac:r,expires:Date.now()+3e5}}}:t))},$=async a=>{let r=e.find(e=>e.isDHCP);if(!r||!r.ip)return;let s=e.find(e=>e.id===a);if(!s)return;let n=V("Discover",s.mac,"00:00:00:00:00:00");await L(a,null,"DHCP Discover",n);let l="192.168.1.".concat(A),i=V("Offer",s.mac,r.mac,r.ip,l);await L(r.id,a,"DHCP Offer",i),Y(a,r.ip,r.mac);let c=V("Request",s.mac,r.mac,void 0,l);await L(a,r.id,"DHCP Request",c);let o=V("Acknowledge",s.mac,r.mac,r.ip,l);await L(r.id,a,"DHCP Acknowledge",o),t(e=>e.map(e=>e.id===a?{...e,ip:l}:e)),M(e=>{let t=e+1;return t>254?11:t})},J=async()=>{if(null!==c&&null!==d){let t=e.find(e=>e.id===c),a=e.find(e=>e.id===d);if(t&&a&&t.ip&&a.ip){if(!t.arpTable[a.ip]||t.arpTable[a.ip].expires<Date.now()){let r=E("Request",t.mac,t.ip,"00:00:00:00:00:00",a.ip);await L(c,null,"ARP Request",r),e.forEach(e=>{e.id!==c&&null!==e.os&&"DHCP"!==e.os&&Y(e.id,t.ip,t.mac)});let s=E("Reply",a.mac,a.ip,t.mac,t.ip);await L(d,c,"ARP Reply",s),Y(c,a.ip,a.mac)}let r=B("Request",t.mac,a.mac,t.ip,a.ip);await L(c,d,"ICMP Request",r),Y(d,t.ip,t.mac);let s=B("Reply",a.mac,t.mac,a.ip,t.ip);await L(d,c,"ICMP Reply",s)}}},U=e=>{o(e),e===d&&f(c)};return(0,s.useEffect)(()=>{b.current&&(b.current.scrollTop=b.current.scrollHeight)},[l]),(0,r.jsxs)("div",{className:"flex flex-col h-screen",ref:g,children:[(0,r.jsxs)("div",{className:"flex-1 overflow-auto p-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Network Simulator"}),(0,r.jsx)(u,{onClick:()=>{t([...e,{id:a,name:"VM".concat(a),os:null,mac:q(),arpTable:{}}]),n(a+1)},className:"mb-4",children:"Add Virtual Machine"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-4 mb-8 relative",children:[e.map(e=>(0,r.jsx)(m,{className:"p-2 w-48",ref:t=>{t?v.current[e.id]=t:delete v.current[e.id]},children:(0,r.jsxs)(p,{className:"p-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:e.name}),!e.isDHCP&&(0,r.jsx)(u,{variant:"ghost",size:"icon",onClick:()=>O(e.id),className:"h-6 w-6 p-0",children:(0,r.jsx)(D.Z,{className:"h-4 w-4"})})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(z,{os:e.os}),!e.isDHCP&&(e.os?(0,r.jsx)("span",{className:"text-sm font-medium",children:e.os}):(0,r.jsxs)(y,{value:e.os||"",onValueChange:t=>I(e.id,t),children:[(0,r.jsx)(j,{className:"w-16 h-8",children:(0,r.jsx)(w,{placeholder:"OS"})}),(0,r.jsxs)(N,{children:[(0,r.jsx)(C,{value:"OS1",children:"OS1"}),(0,r.jsx)(C,{value:"OS2",children:"OS2"})]})]}))]}),(0,r.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["MAC: ",e.mac,e.ip&&(0,r.jsxs)("span",{children:[(0,r.jsx)("br",{}),"IP: ",e.ip]})]})]})},e.id)),e.map(t=>e.map(e=>t.id!==e.id&&(0,r.jsx)(H.Z,{ref:a=>{a?F.current["zap-".concat(t.id,"-").concat(e.id)]=a:delete F.current["zap-".concat(t.id,"-").concat(e.id)]},className:"fixed text-yellow-400",style:{left:0,top:0,transform:"translate(0px, 0px)",display:"none"}},"zap-".concat(t.id,"-").concat(e.id))))]})]}),(0,r.jsx)("div",{className:"p-4 border-t border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)(y,{value:(null==c?void 0:c.toString())||"",onValueChange:e=>U(Number(e)),children:[(0,r.jsx)(j,{className:"w-[180px]",children:(0,r.jsx)(w,{placeholder:"Select source VM"})}),(0,r.jsx)(N,{children:e.filter(e=>null!==e.os&&"DHCP"!==e.os).map(e=>(0,r.jsx)(C,{value:e.id.toString(),children:e.name},e.id))})]}),(0,r.jsx)("span",{children:"→"}),(0,r.jsxs)(y,{value:(null==d?void 0:d.toString())||"",onValueChange:e=>f(Number(e)),children:[(0,r.jsx)(j,{className:"w-[180px]",children:(0,r.jsx)(w,{placeholder:"Select target VM"})}),(0,r.jsx)(N,{children:e.filter(e=>e.id!==c&&null!==e.os).map(e=>(0,r.jsx)(C,{value:e.id.toString(),children:e.name},e.id))})]}),(0,r.jsx)(u,{onClick:J,disabled:null===c||null===d,children:"Ping"})]})}),(0,r.jsxs)("div",{className:"h-1/3 bg-gray-100 p-4 flex",children:[(0,r.jsxs)("div",{className:"w-1/2 pr-2 flex flex-col",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Network Packets"}),(0,r.jsx)("div",{ref:b,className:"flex-1 overflow-auto space-y-2 bg-white",children:l.map(t=>{var a,s;return(0,r.jsxs)("div",{className:"".concat(G(t.type)," px-2 rounded text-sm cursor-pointer leading-tight font-bold ").concat((null==x?void 0:x.id)===t.id?"bg-gray-200":""),onClick:()=>h(t),children:[t.type,": ",null===(a=e.find(e=>e.id===t.from))||void 0===a?void 0:a.name," → ",-1===t.to?"Broadcast":null===(s=e.find(e=>e.id===t.to))||void 0===s?void 0:s.name]},t.id)})})]}),(0,r.jsxs)("div",{className:"w-1/2 pl-2 flex flex-col",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Packet Dump"}),(0,r.jsx)("div",{className:"flex-1 overflow-auto bg-white p-2 rounded",children:x?(0,r.jsx)("pre",{className:"text-xs font-mono",children:x.data}):(0,r.jsx)("p",{className:"text-gray-500",children:"Select a packet to view its hex dump"})})]})]})]})}}},function(e){e.O(0,[758,971,23,744],function(){return e(e.s=4056)}),_N_E=e.O()}]);